# Example

DocumentLab is useful in cases when we have a document available to us only in the form of a static PDF/shoto/scanned and we're only able to access the information in the file as a bitmap. This is the case with a lot of communications formats even still today since digitalization and standardization of these things only go so far when we've got countless of different systems doing the same things.

For example,
* Invoices
* Purchase orders
* Annual reports
* Sales reports
* ... So many things. What can you think of?

The following image is used in this example. 

<img src="https://github.com/karisigurd4/DocumentLab/blob/master/DocumentLabCL/Examples/Example1.png" width="70%" />

---

And the following script containing queries specifying what data we'd like to retrieve

```
// Start by finding the text "Label1" and then moving right until we capture an email
Label1: 
Text(Label1) Right Amount Right [Email];

// Start by finding any text and capture the WebAddress to the right of it
// Only one row in the image will match this pattern
Label2: 
Text Right [WebAddress];

// Specify a pattern with named captures, result will be a json object 
LastColumn: 
'EmailAddress': [Email] Down 'WebAddress': [WebAddress] Down 'Number': [Number] Down 'Text': [Text];

// Capture any date in the document
Dates: 
Any [Date];
```

The following predicates are valid from the text analysis classifications,
* AmountOrNumber
* Amount
* Date
* Email
* InvoiceNumber
* Letter
* Number
* PageNumber
* Percentage
* Text 
* WebAddress
* Definitions by custom files under *Data\Context* (see: [techical overview](https://github.com/karisigurd4/DocumentLab/blob/master/Documentation/Overview.md) text analysis section)

This is the output generated by DocumentLab

```json
{
  "Label1": "email@email.com",
  "Label2": "http://www.website.com/",
  "LastColumn": {
    "EmailAddress": "email@email.com",
    "WebAddress": "http://www.website.com/",
    "Number": "50",
    "Text": "Example"
  },
  "Dates": [
    "2018-01-01",
    "2019-12-26"
  ]
}
```

## Interface usage in C#

If you want to map the result to a C# object you can define a corresponding one such as the following

```C#
public class LastColumn 
{
  public string Email { get; set; }
  public string WebAddress { get; set; }
  public int Number { get; set; }
  public string Text { get; set; }
}

public class Result 
{
  public string Label1 { get; set; }
  public string Label2 { get; set; }
  public LastColumn LastColumn { get; set; }
  public DateTime[] Dates { get; set; }
}
```

Then map the object with a Json converter, for instance the following

```C#
var documentLab = new DocumentLab();
var interpretedJsonResult = documentLab.InterpretToJson(script, bitmap);
var asObject = JsonConvert.DeserializeObject<Result>(interpretedJsonResult)
```
